id: multi-takeover-check
info:
  name: Instagram, LinkedIn, X, YouTube Takeover Check
  author: pastaga
  severity: high

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: status
        status:
          - 200

    extractors:

      # --- Instagram ---
      - type: regex
        name: instagram-username
        group: 1
        regex:
          - https:\/\/(?:www\.)?instagram\.com\/([^"'/\s<]+)

      # --- X.com ---
      - type: regex
        name: x-username
        group: 1
        regex:
          - https:\/\/(?:www\.)?x\.com\/([^"'/\s<]+)

      # --- LinkedIn (company) ---
      - type: regex
        name: linkedin-company
        group: 1
        regex:
          - https:\/\/(?:www\.)?linkedin\.com\/company\/([^"'/\s<]+)

      # --- YouTube (user) ---
      - type: regex
        name: youtube-user
        group: 1
        regex:
          - https:\/\/(?:www\.)?youtube\.com\/user\/([^"'/\s<]+)

  - method: GET
    path:
      - "https://www.instagram.com/{{instagram-username}}"

    matchers:
      - type: word
        name: instagram-takeover
        words:
          - "Sorry, this page isn't available."

  - method: GET
    path:
      - "https://www.x.com/{{x-username}}"

    matchers:
      - type: word
        name: x-takeover
        words:
          - "Ce compte n'existe pas."

  - method: GET
    path:
      - "https://www.linkedin.com/company/{{linkedin-company}}"

    matchers:
      - type: word
        name: linkedin-takeover
        words:
          - "Cette page LinkedIn nâ€™est pas disponible"

  - method: GET
    path:
      - "https://www.youtube.com/user/{{youtube-user}}"

    matchers:
      - type: status
        name: youtube-takeover
        status:
          - 404
